# Investigation Process

## Scenario Overview

A SOC Level 1 analyst received an alert related to a suspicious file downloaded on an employee workstation within a financial services organization.  
The alert was triggered after the execution of a malicious attachment delivered via email.

The objective of this investigation was to validate the alert, analyze the suspicious file, and determine the appropriate response actions.

---

## Incident Timeline

- **1:11 PM** – The employee received an email containing a file attachment.
- **1:13 PM** – The employee successfully downloaded and opened the file.
- **1:15 PM** – The file created multiple unauthorized executable files on the employee’s system.
- **1:20 PM** – The Intrusion Detection System (IDS) detected suspicious activity and generated an alert sent to the Security Operations Center (SOC).

---

## Initial Investigation

Following the alert, the SOC analyst confirmed that the downloaded file was associated with suspicious system behavior.  
A **SHA256 hash** was generated for the file to uniquely identify it without re-executing or redistributing the file.

Hashing was used because:
- Each file has a unique cryptographic fingerprint.
- Hash-based analysis allows investigation without directly uploading sensitive files.
- SHA256 is a standard and reliable hashing algorithm used in malware analysis.

---

## Malware Analysis Using VirusTotal

The SHA256 hash was submitted to **VirusTotal** for further investigation.

Key findings included:
- Approximately **59 security vendors** classified the file as **malicious**, indicating a high confidence level.
- Multiple detection engines agreed on the malicious nature of the file.
- Additional insights were gathered from VirusTotal analysis sections, including:
  - **Detection**
  - **Details**
  - **Relations**
  - **Behavior**

The **Behavior** analysis was the most critical, as it revealed:
- Unauthorized creation of executable files.
- Abnormal execution patterns consistent with malicious payload activity.

These behaviors strongly indicated malware execution rather than a false positive.

---

## Incident Assessment and Escalation

Based on the investigation results:
- The alert was **escalated** due to confirmed malicious activity.
- The affected endpoint required immediate isolation to prevent lateral movement.
- Further checks were necessary to ensure no data exfiltration or network spread occurred.

This response aligned with standard SOC incident handling procedures.

---

## Preventive and Awareness Measures

Following containment, several preventive actions were identified:
- Blocking the malicious email source through email security controls and proxy filtering.
- Updating detection rules to prevent similar threats.
- Increasing employee awareness regarding suspicious email attachments and phishing attempts.

User awareness remains a critical defensive layer against email-based malware delivery.

---

## Summary

This investigation demonstrated a structured SOC workflow:
- Alert validation through behavioral indicators.
- Malware identification using hash-based analysis.
- Threat confirmation through VirusTotal intelligence.
- Proper escalation and containment decisions.

The process highlights the importance of combining technical analysis with operational response to effectively manage security incidents.
